<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Usuarios</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1946/1946488.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <h1>CRUD de Usuarios</h1>
        <p>Proyecto Backend en Node.js + Express</p>
    </header>

    <section class="project-intro">
        <h2>DescripciÃ³n</h2>
        <p>Este proyecto es una API REST que permite crear, leer, actualizar y eliminar usuarios.</p>
    </section>

    <section class="project-preview">
        <h2>Vista previa de la API</h2>
        <div class="preview-card">
            <h3>Endpoints principales</h3>
            <ul>
                <li><code>GET /api/users</code> â†’ Listar usuarios</li>
                <li><code>POST /api/users</code> â†’ Crear usuario</li>
                <li><code>PUT /api/users/:id</code> â†’ Actualizar usuario</li>
                <li><code>DELETE /api/users/:id</code> â†’ Eliminar usuario</li>
            </ul>
            <p class="small">Se usa Node.js + Express y estructura MVC.</p>
        </div>
    </section>
    
    <!-- SecciÃ³n de prueba del CRUD -->
  <section class="crud-test">
  <h2>Probar CRUD de Usuarios</h2>

  <!-- Botonera -->
  <div class="crud-buttons">
    <button onclick="toggleForm('createForm')">Crear Usuario</button>
    <button onclick="toggleForm('readForm')">Leer Usuario</button>
    <button onclick="toggleForm('updateForm')">Actualizar Usuario</button>
    <button onclick="toggleForm('deleteForm')">Eliminar Usuario</button>
    <button onclick="loadUsers()">Mostrar Lista</button>
    <button onclick="deleteAllUsers()">Eliminar Todos</button>
  </div>

  <!-- Formularios ocultos -->
  <div id="createForm" class="crud-form hidden">
    <input type="text" id="name" placeholder="Nombre">
    <input type="email" id="email" placeholder="Email">
    <button onclick="createUser()">Confirmar</button>
  </div>

  <div id="readForm" class="crud-form hidden">
    <input type="number" id="readId" placeholder="ID a leer">
    <button onclick="getUserById()">Confirmar</button>
  </div>

  <div id="updateForm" class="crud-form hidden">
    <input type="number" id="updateId" placeholder="ID a actualizar">
    <input type="text" id="updateName" placeholder="Nuevo Nombre">
    <input type="email" id="updateEmail" placeholder="Nuevo Email">
    <button onclick="updateUser()">Confirmar</button>
  </div>

  <div id="deleteForm" class="crud-form hidden">
    <input type="number" id="deleteId" placeholder="ID a eliminar">
    <button onclick="deleteUserById()">Confirmar</button>
  </div>

  <!-- Lista -->
  <div class="crud-results">
    <h3>Lista de Usuarios</h3>
    <ul id="user-list"></ul>
  </div>
</section>

    <footer>
        <p>ðŸ’» Creado por Julito </p>
        <a href="https://github.com/jjulito" target="_blank" class="btn github">
    <i class="fab fa-github"></i>
    </footer>
    
    <script>

function toggleForm(formId) {
  document.querySelectorAll(".crud-form").forEach(form => {
    form.classList.add("hidden");
  });
  document.getElementById(formId).classList.remove("hidden");
}
        
  const API_URL = "https://crud-usuarios-1zkp.onrender.com/api/users";

  // Mostrar todos los usuarios
  async function loadUsers() {
    try {
      const res = await fetch(API_URL);
      const users = await res.json();
      const list = document.getElementById("user-list");
      list.innerHTML = "";
      users.forEach(u => {
        const li = document.createElement("li");
        li.textContent = `ID: ${u.id} - ${u.name} (${u.email})`;
        list.appendChild(li);
      });
    } catch (err) {
      console.error(err);
      alert("Error cargando usuarios");
    }
  }

  // Crear usuario
  async function createUser() {
    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    if (!name || !email) return alert("Completa todos los campos");

    try {
      await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email })
      });
      alert("Usuario creado");
    } catch (err) {
      console.error(err);
      alert("Error creando usuario.");
    }
  }

  // Leer usuario por ID
  async function getUserById() {
    const id = document.getElementById("readId").value;
    if (!id) return alert("Ingresa un ID");

    try {
      const res = await fetch(`${API_URL}/${id}`);
      if (!res.ok) return alert("Usuario no encontrado");
      const user = await res.json();
      alert(`Usuario encontrado:\nID: ${user.id}\nNombre: ${user.name}\nEmail: ${user.email}`);
    } catch (err) {
      console.error(err);
      alert("Error leyendo usuario.");
    }
  }

  // Actualizar usuario por ID
  async function updateUser() {
    const id = document.getElementById("updateId").value;
    const name = document.getElementById("updateName").value;
    const email = document.getElementById("updateEmail").value;
    if (!id) return alert("Ingresa un ID para actualizar");

    try {
      const res = await fetch(`${API_URL}/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email })
      });
      if (!res.ok) return alert("Usuario no encontrado");
      alert("Usuario actualizado");
    } catch (err) {
      console.error(err);
      alert("Error actualizando usuario.");
    }
  }

  // Eliminar usuario por ID
  async function deleteUserById() {
    const id = document.getElementById("deleteId").value;
    if (!id) return alert("Ingresa un ID para eliminar");
    if (!confirm("Â¿Seguro que quieres eliminar este usuario?")) return;

    try {
      const res = await fetch(`${API_URL}/${id}`, { method: "DELETE" });
      if (!res.ok) return alert("Usuario no encontrado");
      alert("Usuario eliminado");
    } catch (err) {
      console.error(err);
      alert("Error eliminando usuario.");
    }
  }

  // Eliminar todos
  async function deleteAllUsers() {
    if (!confirm("Â¿Eliminar todos los usuarios?")) return;
    try {
      await fetch(API_URL, { method: "DELETE" });
      alert("Todos los usuarios eliminados");
    } catch (err) {
      console.error(err);
      alert("Error eliminando usuarios.");
    }
  }
</script>

    
</body>
</html>
